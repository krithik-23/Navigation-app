
select, button{
padding:12px;
font-size:16px;
margin-right:10px;
}

#map{
height:80vh;
}
</style>
</head>

<body>

<header>ðŸŽ“ Smart Polytechnic Campus Navigation</header>

<div id="controls">
<select id="destination">
<option value="">-- Select Branch --</option>
<option value="che">Computer Hardware Engineering</option>
<option value="mech">Mechanical Engineering</option>
<option value="inst">Instrumentation Engineering</option>
<option value="civil">Civil Engineering</option>
<option value="ece">Electronics Engineering</option>
<option value="eee">Electrical & Electronics Engineering</option>
</select>

<button onclick="startNavigation()">Start Navigation</button>
</div>

<div id="map"></div>

<script>
// MAP SETUP
var map = L.map('map', {
  crs: L.CRS.Simple,
  minZoom: -1
});

var bounds = [[0,0],[1000,1000]];
L.imageOverlay('campus.png', bounds).addTo(map);
map.fitBounds(bounds);

// ENTRANCE
var entrance = [100,100];

var walker = L.circleMarker(entrance,{
radius:8,
color:"blue",
fillColor:"blue",
fillOpacity:1
}).addTo(map);

// BRANCH LOCATIONS (DRAGGABLE)
var branches = {
che: [250,250],
mech: [400,700],
inst: [300,850],
civil: [650,250],
ece: [700,500],
eee: [850,750]
};

var branchMarkers = {};

// ADD BRANCH MARKERS
for(let key in branches){
branchMarkers[key] = L.marker(branches[key], {
  draggable:true
}).addTo(map)
.bindPopup(key.toUpperCase()+"<br>Drag to fix location");

branchMarkers[key].on('dragend', function(e){
  branches[key] = [
    e.target.getLatLng().lat,
    e.target.getLatLng().lng
  ];
  e.target.bindPopup(
    key.toUpperCase()+"<br>Lat: "+branches[key][0].toFixed(0)+
    "<br>Lng: "+branches[key][1].toFixed(0)
  ).openPopup();
});
}

// SUB LOCATIONS (RED POINTS)
var subLocations = [
  [260,260,"CHE Lab"],
  [270,280,"CHE Store"],
  [410,720,"Mech Workshop"],
  [430,750,"Mech Lab"],
  [660,260,"Civil Survey Lab"],
  [680,280,"Civil Drawing Hall"],
  [720,520,"ECE Lab"],
  [740,540,"ECE Store"],
  [860,760,"EEE Power Lab"],
  [880,780,"EEE Control Lab"]
];

subLocations.forEach(loc=>{
  L.circleMarker([loc[0],loc[1]],{
    radius:6,
    color:"red",
    fillColor:"red",
    fillOpacity:1
  }).addTo(map)
  .bindPopup(loc[2]);
});

var routeLine;

// NAVIGATION FUNCTION
function startNavigation(){
let selected = document.getElementById("destination").value;
if(selected===""){
alert("Select a branch");
return;
}

if(routeLine){
map.removeLayer(routeLine);
}

let target = branches[selected];
let path = [];
let steps = 100;

for(let i=0;i<=steps;i++){
path.push([
entrance[0] + (target[0]-entrance[0])*(i/steps),
entrance[1] + (target[1]-entrance[1])*(i/steps)
]);
}

routeLine = L.polyline([entrance,target],{
color:"red",
weight:4
}).addTo(map);

animatePath(path);
}

function animatePath(path){
let i=0;
let interval = setInterval(()=>{
if(i>=path.length){
clearInterval(interval);
return;
}
walker.setLatLng(path[i]);
i++;
},40);
}
</script>

</body>
</html>
